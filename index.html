<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Device Orientation</title>
</head>
<body>
    <pre id="container">...!</pre>
    <div id="msg">
        <p>X Axis: <span class="axis--x"></span></p>
        <p>Y Axis: <span class="axis--y"></span></p>
        <p>Z Axis: <span class="axis--z"></span></p>
        Hello, world.
    </div>
    <script>
    ( function( window, document ) {
        console.log( 'INSIDE `iife`' ); /// TEMP

        // DECLARE VARS
        var elem = document.querySelector( '#container' );
        var msgElem = document.querySelector( '#msg' );
        var xAxisElem = document.querySelector( '.axis--x' );
        var yAxisElem = document.querySelector( '.axis--y' );
        var zAxisElem = document.querySelector( '.axis--z' );


        let coords = {
            alpha: null,
            beta: null,
            gamma: null,
        };

        let lastCoords;

        // DECLARE FUNCTIONS
        function handleOrientationChange( e ) {
            coords = {
                absolute: e.absolute,
                alpha: parseInt( e.alpha ),
                beta: parseInt( e.beta ),
                gamma: parseInt( e.gamma ),
            };
        }

        function updateView() {
            if ( !lastCoords ) {
                lastCoords = coords;
            }

            var output = '';

            output += coords.absolute;
            output += '\n';
            output += coords.alpha;
            output += '\n';
            output += coords.beta;
            output += '\n';
            output += coords.gamma;

            elem.innerHTML = output;

            xAxisElem.innerHTML = ( lastCoords.beta && coords.beta >= lastCoords.beta ) ? 'Turning Right' : 'Turning Left';
            yAxisElem.innerHTML = ( lastCoords.gamma && coords.gamma >= lastCoords.gamma ) ? 'Tilting Away' : 'Tilting Towards';
            zAxisElem.innerHTML = ( lastCoords.alpha && coords.alpha >= lastCoords.alpha ) ? 'Rotating Left' : 'Rotating Right';

            lastCoords = coords;
        }

        // INIT
        window.addEventListener( 'DOMContentLoaded', function() {
            window.addEventListener( 'deviceorientation', handleOrientationChange );

            setInterval( updateView, 50 );
        } );

    } )( window, document );
    </script>
</body>
</html>
